---
title: JSé€†å‘ç®—æ³•è¿˜åŸå¸¸ç”¨æŠ€å·§
author: Payne
tags:
  - Crawler
categories:
  - - JavaScript
    - æŠ€å·§
    - JS
abbrlink: 1413352655
date: 2021-12-23 15:19:04
---

Hiï¼Œè®¸ä¹…ä¸è§ï¼Œæˆ‘æ˜¯Payneå•Šã€‚

okï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆè¯´è¯´æ ¸å¿ƒæœ¬è´¨å§ï¼Œå…¶æ ¸å¿ƒæœ¬è´¨ä¸ªäººè®¤ä¸ºä¾æ—§æ˜¯ä¼ªè£…ã€‚å°±åƒçˆ¬è™«ä¸ºå¯¹é¢å¯¹åçˆ¬è™«ååˆ¶ï¼Œä»è€Œæ·»åŠ ç‰¹å¾ï¼Œä¸æ–­çš„é€¼è¿‘**åƒ**çœŸäººã€‚

è‡ªç„¶åœ¨å‚æ•°ã€ç¯å¢ƒè¿˜åŸè¿™é‡Œä¹Ÿæ˜¯ã€‚

æ— è®ºæ˜¯ä¸€ä¸‹çš„**è¡¥ç¯å¢ƒ**ã€**æ‰£ä»£ç **ã€**æ‰‹åŠ¨è¿˜åŸ**ï¼Œä¹Ÿéƒ½æ˜¯åœ¨æ¨¡æ‹Ÿç”ŸæˆåŠ å¯†é€»è¾‘ã€‚

## è¡¥ç¯å¢ƒ

### è¡¥ç¯å¢ƒçš„å®šä¹‰

è¡¥ç¯å¢ƒé¡¾åæ€ä¹‰å°±æ˜¯ï¼Œå°†è·å–åˆ°çš„å…³é”®JSåœ¨é€šè¿‡**ä¿®è¡¥ç¯å¢ƒ**çš„æ–¹æ³•åœ¨æœ¬åœ°æˆ–æœåŠ¡å™¨ä¸Šèƒ½å¤Ÿæ­£å¸¸è¿è¡Œè·å–åˆ°æ­£ç¡®çš„è¿”å›å€¼ï¼Œä»è€Œå®Œæˆå‚æ•°çš„åŠ å¯†æ¨¡æ‹Ÿã€‚

å½“ç„¶å¤§éƒ¨åˆ†æƒ…å†µä¸‹è¡¥ç¯å¢ƒä¸æŠ ä»£ç å¯†ä¸å¯åˆ†ï¼ˆä¸€èˆ¬æ˜¯æ‰£ä»£ç ï¼Œç„¶ååœ¨è¡¥ç¯å¢ƒï¼‰ï¼Œæ‰£ä»£ç ç§»æ­¥ç¬¬äºŒéƒ¨åˆ†

### æ ¸å¿ƒæœ¬è´¨

æ— è®ºæ˜¯ç¼ºå•¥è¡¥å•¥çš„å‰çš„æ„å»ºé”™è¯¯ï¼Œè¿˜æ˜¯ä½¿ç”¨ä»£ç†ç›‘æ§è¿è¡Œã€‚éƒ½æ˜¯åœ¨åšé“¾è·¯è¿½è¸ªã€‚åœ¨è¡¥ç¯å¢ƒè¿™é‡Œæ˜¯ç§‰æ‰¿ç€é‡æ²³æ­æ¡¥ï¼Œç¼ºå•¥è¡¥å•¥æ€è·¯ã€‚

å¸¸ç”¨çš„æ–¹æ³•ä¸€èˆ¬æœ‰ä¸¤ä¸ªï¼š

> å‡è®¾è·å–åˆ°äº†æ ¸å¿ƒçš„JSä»£ç å

ä¸€ç§æ˜¯ä½¿ç”¨è¿è¡Œï¼Œä»è€Œæ„å»ºé”™è¯¯å®ç°æŠ¥é”™ï¼Œç„¶åé€šè¿‡è¡¥æ–¹æ³•ã€å¯¹è±¡æ¥fixã€‚ä»è€Œå®Œæˆè¡¥ç¯å¢ƒï¼Œï¼ˆå½“ç„¶è¿™æ˜¯å¿…é¡»çš„ï¼‰ã€‚

å½“å®Œæˆä»¥ä¸Šçš„æ“ä½œåï¼Œé‡è§é£æ§ã€é‡è§ä¼ç‚¹ã€‚å¯ä»¥æ­£å¸¸é€šè¿‡è¿è¡Œï¼Œä½†æ— æ³•è·å–åˆ°æ­£ç¡®çš„å‚æ•°ã€‚æ­¤æ—¶ä½¿ç”¨`Proxy`æ¥ç›‘å¬å®ç°ç›‘æµ‹ï¼ŒååŠ©è°ƒè¯•ã€‚

### å®ç°

æ˜¯æ–¹æ³•å†™ç©ºæ–¹æ³•`arguments`çœ‹ä¼ å‚ï¼Œå¯¹è±¡å†™ç©ºå¯¹è±¡`Proxy`æ¥ç›¸åŠ©ï¼Œè¿›è¡Œé“¾è·¯è¿½è¸ªï¼Œå®Œæˆæ¨¡æ‹Ÿ

```javascript
window = global;
document = {
    location: {'protocol': 'https:'},
    referrer: '',
    getElementById: () => {
        console.log("getElementById:", arguments);
    },
    getElementsByClassName: () => {
        console.log("getElementsByClassName:", arguments);
    },
    getElementsByName: () => {
        console.log("getElementsByName:", arguments);
    },
    getElementsByTagName: () => {
        console.log("getElementsByTagName:", arguments);
    },
    getElementsByTagNameNS: () => {
        console.log("getElementsByTagNameNS:", arguments);
    },
    createElement: () => {
        console.log("createElement:", arguments);
    }

};
navigator = {
    appCodeName: "Mozilla",
    appName: "Netscape",
    appVersion: "5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36",
    language: "zh-CN",
    languages: (2)['zh-CN', 'zh'],
    platform: "MacIntel",
    product: "Gecko",
    productSub: "20030107",
    userAgent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36",
    vendor: "Google Inc.",
};
screen = {
    availHeight: 1055,
    availLeft: 0,
    availTop: 25,
    availWidth: 1920,
    colorDepth: 24,
    height: 1080,
    pixelDepth: 24,
    width: 1920,
};
location = {
    href: 'https://www.xxx.com/website-login/captcha?redirectPath=https%3A%2F%2Fwww.xxx.com%2Fdiscovery%2Fitem%2F618bf8f60000000001027ccd',
    hostname: 'www.xxx.com',
    host: 'www.xxx.com',
};
```

### å°ç»“

1. ç¼ºå•¥è¡¥å•¥ï¼šé€šè¿‡æœ¬åœ°è¿è¡Œå®ç°é”™è¯¯

Proxy

ç©ºå¯¹è±¡ï¼šä½¿ç”¨proxyä»£ç†ï¼Œç©ºæ–¹æ³•ï¼šä½¿ç”¨å…¶ä¸­çš„`arguments`ï¼Œè·å–ä¼ å…¥å‚æ•°

è·å–DOMèŠ‚ç‚¹ï¼šå½“åš`[ ]`å¤„ç†

åˆ›å»ºDOMèŠ‚ç‚¹ï¼šå½“ä½œ`{ }`å¤„ç†

```javascript
null_function = () => {
    console.log(arguments)
};


// ä»£ç†
const proxy = (obj, obj_name) => {
    return new Proxy(obj, {
        get: (target, key) => {
            console.log(obj_name, "Getting", key)
            return target[key];
        },
    })
}


//åç¯å¢ƒ
function proxy(proxy_array) {
    for (let i = 0; i < proxy_array; i++) {
        eval(proxy_array[i] + ' = new Proxy(' + proxy_array[i] + ',{ ' +
            'get(target,key){ ' +
            'debugger;' +
            'console.log("====================")' +
            'console.log("è·å–äº†",' + proxy_array[i] + ' çš„keyå±æ€§"); ' +
            'console.log("====================")' +
            'return target[key]; }')
    }
}

//å¸¸ç”¨çš„proxy_array
var proxy_array = ["window", "document", "location", "navigator"]
proxy(proxy_array)
```

## æŠ ä»£ç 

æ‰¾åˆ°å…³é”®å…¥å£ï¼ŒæŠ ä¸‹æ¥ğŸ¶ï½ã€‚

é‡åœ¨è°ƒè¯•ï¼Œä¸å†æŠ ï¼ˆæŠ å°±æ˜¯å¤åˆ¶ç²˜è´´ï¼‰

å°æŠ€å·§ï¼š

æ‰“å¼€æµè§ˆå™¨çš„è®¾ç½®ï¼Œæ‰¾åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„`code filding` å‹¾é€‰æ‰“å¼€ã€‚JSä»£ç æ”¶ç¼©å¤åˆ¶ä¸€æ°”å‘µæˆï¼Œå¦™å•Šï½

![image-20211223145757359](https://tva1.sinaimg.cn/large/008i3skNgy1gxnrxih3bqj308v07mweo.jpg)

## æ‰‹åŠ¨è¿˜åŸ

é€šè¿‡è°ƒè¯•æŸ¥çœ‹ç®—æ³•å®ç°è¿‡ç¨‹ï¼Œç»“åˆåŠ å¯†åº“å¤ç°ã€‚

> Tip: å¯ä»¥ä½†æ²¡å¿…è¦ï¼Œæ‰‹æ’•éšçˆ½ï¼Œä½†å¯ä¸è¦è´ªæ¯å“¦
